{% extends "base.html" %}

{% block title %}{{ cliente.nombre }} - Sistema de Lecturas{% endblock %}

{% block content %}
<!-- Page Header -->
<div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6">
    <h1 class="text-2xl font-bold">{{ cliente.nombre }}</h1>
    <div class="flex flex-wrap gap-2">
        <a href="{{ url_for('clientes.editar', cliente_id=cliente.id) }}" class="btn btn-primary btn-sm"><i class="fas fa-edit"></i> Editar</a>
        <button type="button" class="btn btn-error btn-sm" onclick="eliminarCliente()"><i class="fas fa-trash"></i> Eliminar</button>
        <a href="{{ url_for('clientes.listar') }}" class="btn btn-secondary btn-sm">Volver</a>
    </div>
</div>

<!-- Stats Section -->
<div class="stats stats-vertical lg:stats-horizontal shadow mb-6 w-full">
    <div class="stat">
        <div class="stat-title">Estado</div>
        <div class="stat-value text-lg">
            {% if cliente.activo %}
            <span class="badge badge-success">Activo</span>
            {% else %}
            <span class="badge badge-ghost">Inactivo</span>
            {% endif %}
        </div>
    </div>
    <div class="stat">
        <div class="stat-title">RUT</div>
        <div class="stat-value text-lg">{{ cliente.rut or '-' }}</div>
    </div>
    <div class="stat">
        <div class="stat-title">Telefono</div>
        <div class="stat-value text-lg">{{ cliente.telefono or '-' }}</div>
    </div>
</div>

<div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    <!-- Datos del Cliente -->
    <div class="card bg-base-100 shadow">
        <div class="card-body">
            <h2 class="card-title">Datos del Cliente</h2>

            <!-- Mobile View -->
            <div class="lg:hidden space-y-3">
                <div class="flex justify-between border-b border-base-200 pb-2">
                    <span class="font-medium text-base-content/70">Nombre:</span>
                    <span>{{ cliente.nombre }}</span>
                </div>
                <div class="flex justify-between border-b border-base-200 pb-2">
                    <span class="font-medium text-base-content/70">Nombre Completo:</span>
                    <span>{{ cliente.nombre_completo or 'No registrado' }}</span>
                </div>
                <div class="flex justify-between border-b border-base-200 pb-2">
                    <span class="font-medium text-base-content/70">RUT:</span>
                    <span>{{ cliente.rut or 'No registrado' }}</span>
                </div>
                <div class="flex justify-between border-b border-base-200 pb-2">
                    <span class="font-medium text-base-content/70">Telefono:</span>
                    <span>{{ cliente.telefono or 'No registrado' }}</span>
                </div>
                <div class="flex justify-between border-b border-base-200 pb-2">
                    <span class="font-medium text-base-content/70">Correo:</span>
                    <span>{{ cliente.email or 'No registrado' }}</span>
                </div>
                <div class="flex justify-between border-b border-base-200 pb-2">
                    <span class="font-medium text-base-content/70">Estado:</span>
                    <span>
                        {% if cliente.activo %}
                        <span class="badge badge-success">Activo</span>
                        {% else %}
                        <span class="badge badge-ghost">Inactivo</span>
                        {% endif %}
                    </span>
                </div>
                <div class="flex justify-between pb-2">
                    <span class="font-medium text-base-content/70">Registrado:</span>
                    <span>{{ cliente.created_at }}</span>
                </div>
            </div>

            <!-- Desktop View -->
            <div class="hidden lg:block overflow-x-auto">
                <table class="table">
                    <tbody>
                        <tr>
                            <th class="w-1/3">Nombre:</th>
                            <td>{{ cliente.nombre }}</td>
                        </tr>
                        <tr>
                            <th>Nombre Completo:</th>
                            <td>{{ cliente.nombre_completo or 'No registrado' }}</td>
                        </tr>
                        <tr>
                            <th>RUT:</th>
                            <td>{{ cliente.rut or 'No registrado' }}</td>
                        </tr>
                        <tr>
                            <th>Telefono:</th>
                            <td>{{ cliente.telefono or 'No registrado' }}</td>
                        </tr>
                        <tr>
                            <th>Correo Electronico:</th>
                            <td>{{ cliente.email or 'No registrado' }}</td>
                        </tr>
                        <tr>
                            <th>Estado:</th>
                            <td>
                                {% if cliente.activo %}
                                <span class="badge badge-success">Activo</span>
                                {% else %}
                                <span class="badge badge-ghost">Inactivo</span>
                                {% endif %}
                            </td>
                        </tr>
                        <tr>
                            <th>Registrado:</th>
                            <td>{{ cliente.created_at }}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Accesos Rapidos -->
    <div class="card bg-base-100 shadow">
        <div class="card-body">
            <h2 class="card-title">Accesos Rapidos</h2>
            <div class="flex flex-wrap gap-3">
                <a href="{{ url_for('lecturas.listar', cliente_id=cliente.id) }}" class="btn btn-secondary"><i class="fas fa-tachometer-alt mr-2"></i> Ver Lecturas</a>
                <a href="{{ url_for('boletas.listar', cliente_id=cliente.id) }}" class="btn btn-secondary"><i class="fas fa-file-invoice mr-2"></i> Ver Boletas</a>
            </div>
        </div>
    </div>
</div>

<script>
function eliminarCliente() {
    ConfirmModal.show({
        title: 'Eliminar Cliente',
        message: 'Esta a punto de eliminar al cliente <strong>{{ cliente.nombre }}</strong>. Esta accion no se puede deshacer. Solo se puede eliminar si el cliente no tiene medidores asociados.',
        icon: 'danger',
        confirmText: 'Eliminar',
        confirmClass: 'btn-error'
    }).then(function(ok) {
        if (ok) {
            var form = document.createElement('form');
            form.method = 'POST';
            form.action = '{{ url_for("clientes.eliminar", cliente_id=cliente.id) }}';
            document.body.appendChild(form);
            form.submit();
        }
    });
}
</script>
{% endblock %}
