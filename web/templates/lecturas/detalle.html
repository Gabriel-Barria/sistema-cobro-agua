{% extends "base.html" %}

{% block title %}Lectura #{{ lectura.id }} - Sistema de Lecturas{% endblock %}

{% block content %}
<div class="page-header">
    <h1>Lectura #{{ lectura.id }}</h1>
    <div>
        <a href="{{ url_for('lecturas.editar', lectura_id=lectura.id) }}" class="btn btn--primary"><i class="fas fa-edit"></i> Editar</a>
        <a href="{{ url_for('lecturas.listar') }}" class="btn btn--secondary">Volver</a>
    </div>
</div>

<div class="detail-grid">
    <div class="detail-section">
        <h3>Informacion</h3>
        <table class="detail-table">
            <tr>
                <th>Cliente:</th>
                <td><a href="{{ url_for('clientes.detalle', cliente_id=lectura.cliente_id) }}">{{ lectura.cliente_nombre }}</a></td>
            </tr>
            <tr>
                <th>Medidor:</th>
                <td><a href="{{ url_for('medidores.detalle', medidor_id=lectura.medidor_id) }}">Medidor #{{ lectura.medidor_id }}</a></td>
            </tr>
            <tr>
                <th>Periodo:</th>
                <td>{{ lectura.mes|mes_nombre }} {{ lectura.a√±o }}</td>
            </tr>
            <tr>
                <th>Lectura:</th>
                <td><strong>{{ lectura.lectura_m3 }} m3</strong></td>
            </tr>
            <tr>
                <th>Fecha de Lectura:</th>
                <td>{{ lectura.fecha_lectura|fecha_formato }}</td>
            </tr>
            <tr>
                <th>Archivo Original:</th>
                <td>{{ lectura.foto_nombre or '-' }}</td>
            </tr>
        </table>
    </div>

    <div class="detail-section">
        <h3>Foto</h3>
        {% if lectura.foto_path %}
        <img src="/foto/{{ lectura.foto_path }}" alt="Foto de lectura" style="max-width: 100%; border-radius: var(--radius-md);">
        {% else %}
        <div class="empty-state">
            <div class="empty-state__icon"><i class="fas fa-image"></i></div>
            <p class="empty-state__description">Sin foto</p>
        </div>
        {% endif %}
    </div>
</div>

<div class="actions-section" style="margin-top: var(--spacing-lg); border-top: 2px solid var(--color-danger);">
    <h3 style="color: var(--color-danger);">Zona de Peligro</h3>
    <button type="button" class="btn btn--danger" onclick="eliminarLectura()"><i class="fas fa-trash"></i> Eliminar Lectura</button>
</div>

<script>
function eliminarLectura() {
    ConfirmModal.show({
        title: 'Eliminar Lectura',
        message: 'Esta accion no se puede deshacer. Se eliminara permanentemente esta lectura.',
        icon: 'danger',
        confirmText: 'Eliminar',
        confirmClass: 'btn--danger'
    }).then(function(ok) {
        if (ok) {
            var form = document.createElement('form');
            form.method = 'POST';
            form.action = '{{ url_for("lecturas.eliminar", lectura_id=lectura.id) }}';
            document.body.appendChild(form);
            form.submit();
        }
    });
}
</script>
{% endblock %}
