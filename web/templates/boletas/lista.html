{% extends "base.html" %}

{% block title %}Boletas - Sistema de Lecturas{% endblock %}

{% block content %}
<div class="page-header">
    <h1>Boletas</h1>
    <div>
        <a href="{{ url_for('boletas.crear') }}" class="btn btn-primary">Nueva Boleta</a>
        <a href="{{ url_for('boletas.crear_masivo') }}" class="btn btn-secondary">Crear Masivo</a>
        <a href="{{ url_for('boletas.configuracion') }}" class="btn btn-secondary">Configuracion</a>
    </div>
</div>

{% if stats %}
<div class="stats-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 20px;">
    <div class="stat-card" style="background: #f0f0f0; padding: 15px; border-radius: 5px; text-align: center;">
        <div style="font-size: 24px; font-weight: bold;">{{ stats.total or 0 }}</div>
        <div>Total Boletas</div>
    </div>
    <div class="stat-card" style="background: #d4edda; padding: 15px; border-radius: 5px; text-align: center;">
        <div style="font-size: 24px; font-weight: bold;">{{ stats.pagadas or 0 }}</div>
        <div>Pagadas</div>
    </div>
    <div class="stat-card" style="background: #d1ecf1; padding: 15px; border-radius: 5px; text-align: center;">
        <div style="font-size: 24px; font-weight: bold;">{{ stats.en_revision or 0 }}</div>
        <div>En Revisi√≥n</div>
    </div>
    <div class="stat-card" style="background: #fff3cd; padding: 15px; border-radius: 5px; text-align: center;">
        <div style="font-size: 24px; font-weight: bold;">{{ stats.pendientes or 0 }}</div>
        <div>Pendientes</div>
    </div>
    <div class="stat-card" style="background: #f8d7da; padding: 15px; border-radius: 5px; text-align: center;">
        <div style="font-size: 24px; font-weight: bold;">{{ stats.sin_comprobante or 0 }}</div>
        <div>Sin Comprobante</div>
    </div>
    <div class="stat-card" style="background: #cce5ff; padding: 15px; border-radius: 5px; text-align: center;">
        <div style="font-size: 24px; font-weight: bold;">${{ (stats.monto_pendiente or 0)|formato_pesos }}</div>
        <div>Por Cobrar</div>
    </div>
</div>
{% endif %}

<form method="GET" class="filter-form" style="margin-bottom: 20px; padding: 15px; background: #f5f5f5; border-radius: 5px;">
    <div style="display: flex; flex-wrap: wrap; gap: 10px; align-items: end;">
        <div class="form-group" style="margin: 0;">
            <label for="cliente_id">Cliente</label>
            <select name="cliente_id" id="cliente_id" onchange="this.form.submit()">
                <option value="">Todos</option>
                {% for cliente in clientes %}
                <option value="{{ cliente.id }}" {{ 'selected' if filtros.cliente_id == cliente.id }}>
                    {{ cliente.nombre }}
                </option>
                {% endfor %}
            </select>
        </div>

        {% if medidores %}
        <div class="form-group" style="margin: 0;">
            <label for="medidor_id">Medidor</label>
            <select name="medidor_id" id="medidor_id">
                <option value="">Todos</option>
                {% for medidor in medidores %}
                <option value="{{ medidor.id }}" {{ 'selected' if filtros.medidor_id == medidor.id }}>
                    {{ medidor.numero_medidor or 'Medidor ' ~ medidor.id }}
                </option>
                {% endfor %}
            </select>
        </div>
        {% endif %}

        <div class="form-group" style="margin: 0;">
            <label for="a√±o">A√±o</label>
            <select name="a√±o" id="a√±o">
                <option value="">Todos</option>
                {% for a in a√±os %}
                <option value="{{ a }}" {{ 'selected' if filtros.a√±o == a }}>{{ a }}</option>
                {% endfor %}
            </select>
        </div>

        <div class="form-group" style="margin: 0;">
            <label for="mes">Mes</label>
            <select name="mes" id="mes">
                <option value="">Todos</option>
                {% for m in range(1, 13) %}
                <option value="{{ m }}" {{ 'selected' if filtros.mes == m }}>{{ m }}</option>
                {% endfor %}
            </select>
        </div>

        <div class="form-group" style="margin: 0;">
            <label for="pagada">Estado</label>
            <select name="pagada" id="pagada">
                <option value="">Todos</option>
                <option value="0" {{ 'selected' if filtros.pagada == 0 }}>Pendientes</option>
                <option value="1" {{ 'selected' if filtros.pagada == 1 }}>En Revisi√≥n</option>
                <option value="2" {{ 'selected' if filtros.pagada == 2 }}>Pagadas</option>
            </select>
        </div>

        <div class="form-group" style="margin: 0;">
            <label style="display: flex; align-items: center; gap: 5px;">
                <input type="checkbox" name="sin_comprobante" value="1"
                       {{ 'checked' if filtros.sin_comprobante }}>
                Sin comprobante
            </label>
        </div>

        <button type="submit" class="btn btn-primary">Filtrar</button>
        <a href="{{ url_for('boletas.listar') }}" class="btn btn-secondary">Limpiar</a>
        <a href="{{ url_for('boletas.exportar', cliente_id=filtros.cliente_id, medidor_id=filtros.medidor_id, a√±o=filtros.a√±o, mes=filtros.mes, pagada=filtros.pagada, sin_comprobante=filtros.sin_comprobante) }}"
           class="btn btn-success"
           style="background: #28a745;"
           title="Exportar a Excel con filtros aplicados">
            üìä Exportar a Excel
        </a>
    </div>
</form>

{% if boletas %}
<table class="data-table">
    <thead>
        <tr>
            <th class="sortable">N Boleta</th>
            <th class="sortable">Cliente</th>
            <th class="sortable">Periodo</th>
            <th class="sortable">Consumo</th>
            <th class="sortable">Total</th>
            <th class="sortable">Estado</th>
            <th>Acciones</th>
        </tr>
    </thead>
    <tbody>
        {% for boleta in boletas %}
        <tr>
            <td>{{ boleta.numero_boleta }}</td>
            <td>
                <a href="{{ url_for('boletas.listar', cliente_id=boleta.cliente_id) }}">
                    {{ boleta.cliente_nombre }}
                </a>
            </td>
            <td data-sort="{{ '%04d%02d'|format(boleta.periodo_a√±o, boleta.periodo_mes) }}">
                {{ boleta.periodo_mes }}/{{ boleta.periodo_a√±o }}
            </td>
            <td data-sort="{{ boleta.consumo_m3 }}">{{ boleta.consumo_m3 }} m3</td>
            <td data-sort="{{ boleta.total }}">${{ boleta.total|formato_pesos }}</td>
            <td>
                {% if boleta.pagada == 2 %}
                    <span class="badge badge-success badge-clickable"
                          onclick="abrirModalDesmarcar({{ boleta.id }}, '{{ boleta.numero_boleta }}')"
                          style="cursor: pointer;"
                          title="Click para desmarcar como pagada">
                        Pagada
                    </span>
                    {% if not boleta.comprobante_path %}
                        <span class="badge badge-warning badge-clickable"
                              onclick="abrirModalSubirComprobante({{ boleta.id }}, '{{ boleta.numero_boleta }}')"
                              style="cursor: pointer;"
                              title="Click para subir comprobante">
                            Sin comprobante
                        </span>
                    {% else %}
                        <span class="comprobante-icon"
                              onclick="abrirModalVerComprobante('{{ boleta.comprobante_path }}', '{{ boleta.numero_boleta }}')"
                              style="cursor: pointer; margin-left: 5px; font-size: 16px;"
                              title="Click para ver comprobante">
                            üìé
                        </span>
                    {% endif %}
                {% elif boleta.pagada == 1 %}
                    <span class="badge" style="background: #17a2b8; color: white;">En Revisi√≥n</span>
                    <br>
                    <button onclick="aprobarBoleta({{ boleta.id }})" class="btn btn-sm" style="background: #28a745; color: white; margin-top: 5px; padding: 3px 8px; font-size: 12px;">Aprobar</button>
                    <button onclick="rechazarBoleta({{ boleta.id }})" class="btn btn-sm" style="background: #dc3545; color: white; margin-top: 5px; padding: 3px 8px; font-size: 12px;">Rechazar</button>
                    {% if boleta.comprobante_path %}
                        <br><a href="/{{ boleta.comprobante_path }}" target="_blank" style="font-size: 12px; margin-top: 5px; display: inline-block;">Ver Comprobante</a>
                    {% endif %}
                {% else %}
                    <span class="badge badge-danger badge-clickable"
                          onclick="abrirModalPago({{ boleta.id }}, '{{ boleta.numero_boleta }}')"
                          style="cursor: pointer;"
                          title="Click para marcar como pagada">
                        Pendiente
                    </span>
                {% endif %}
            </td>
            <td class="acciones-icons">
                <a href="{{ url_for('boletas.detalle', boleta_id=boleta.id) }}"
                   class="action-icon"
                   title="Ver detalle">üëÅÔ∏è</a>
                <a href="{{ url_for('boletas.descargar', boleta_id=boleta.id) }}"
                   class="action-icon"
                   title="Descargar boleta">üíæ</a>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<div class="alert alert-info">
    No hay boletas que coincidan con los filtros seleccionados.
</div>
{% endif %}

<!-- Modal para marcar como pagada -->
<div id="modalPago" class="modal" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Marcar boleta como pagada</h3>
            <button onclick="cerrarModalPago()" class="close-btn">&times;</button>
        </div>
        <div class="modal-body">
            <p>Boleta: <strong id="modal-numero-boleta"></strong></p>
            <form id="formPago" method="POST" enctype="multipart/form-data">
                <input type="hidden" name="volver_a_lista" value="1">
                <!-- Campos hidden para preservar filtros -->
                <input type="hidden" name="cliente_id" value="{{ filtros.cliente_id or '' }}">
                <input type="hidden" name="medidor_id" value="{{ filtros.medidor_id or '' }}">
                <input type="hidden" name="a√±o" value="{{ filtros.a√±o or '' }}">
                <input type="hidden" name="mes" value="{{ filtros.mes or '' }}">
                <input type="hidden" name="pagada" value="{{ filtros.pagada or '' }}">
                <input type="hidden" name="sin_comprobante" value="{{ '1' if filtros.sin_comprobante else '' }}">
                <!-- Campos hidden para preservar ordenamiento -->
                <input type="hidden" name="sort_by" value="{{ filtros.sort_by or '' }}">
                <input type="hidden" name="sort_order" value="{{ filtros.sort_order or '' }}">

                <div class="form-group">
                    <label for="metodo_pago">M√©todo de pago:</label>
                    <select name="metodo_pago" id="metodo_pago" required style="width: 100%; padding: 8px;" onchange="toggleComprobante()">
                        <option value="efectivo">Efectivo</option>
                        <option value="transferencia">Transferencia</option>
                    </select>
                </div>
                <div id="comprobanteContainer" class="form-group" style="display: none; margin-top: 15px;">
                    <label for="comprobante">Comprobante de pago:</label>
                    <input type="file" name="comprobante" id="comprobante" accept=".png,.jpg,.jpeg,.gif,.pdf" style="width: 100%; padding: 8px;">
                    <small style="color: #666; display: block; margin-top: 5px;">Formatos permitidos: PNG, JPG, JPEG, GIF, PDF</small>
                </div>
                <div style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                    <button type="button" onclick="cerrarModalPago()" class="btn btn-secondary">Cancelar</button>
                    <button type="submit" class="btn btn-success">Confirmar Pago</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Modal para desmarcar como pagada -->
<div id="modalDesmarcar" class="modal" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h3>¬øDesmarcar como pagada?</h3>
            <button onclick="cerrarModalDesmarcar()" class="close-btn">&times;</button>
        </div>
        <div class="modal-body">
            <p>Boleta: <strong id="modal-desmarcar-numero"></strong></p>
            <p>Esto revertir√° el estado de pago. El comprobante NO ser√° eliminado.</p>
            <form id="formDesmarcar" method="POST">
                <input type="hidden" name="volver_a_lista" value="1">
                <!-- Campos hidden para preservar filtros -->
                <input type="hidden" name="cliente_id" value="{{ filtros.cliente_id or '' }}">
                <input type="hidden" name="medidor_id" value="{{ filtros.medidor_id or '' }}">
                <input type="hidden" name="a√±o" value="{{ filtros.a√±o or '' }}">
                <input type="hidden" name="mes" value="{{ filtros.mes or '' }}">
                <input type="hidden" name="pagada" value="{{ filtros.pagada or '' }}">
                <input type="hidden" name="sin_comprobante" value="{{ '1' if filtros.sin_comprobante else '' }}">
                <!-- Campos hidden para preservar ordenamiento -->
                <input type="hidden" name="sort_by" value="{{ filtros.sort_by or '' }}">
                <input type="hidden" name="sort_order" value="{{ filtros.sort_order or '' }}">

                <div style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                    <button type="button" onclick="cerrarModalDesmarcar()" class="btn btn-secondary">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Confirmar</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Modal para subir comprobante -->
<div id="modalComprobante" class="modal" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Subir comprobante de pago</h3>
            <button onclick="cerrarModalComprobante()" class="close-btn">&times;</button>
        </div>
        <div class="modal-body">
            <p>Boleta: <strong id="modal-comprobante-numero"></strong></p>
            <form id="formComprobante" method="POST" enctype="multipart/form-data">
                <input type="hidden" name="volver_a_lista" value="1">
                <!-- Campos hidden para preservar filtros -->
                <input type="hidden" name="cliente_id" value="{{ filtros.cliente_id or '' }}">
                <input type="hidden" name="medidor_id" value="{{ filtros.medidor_id or '' }}">
                <input type="hidden" name="a√±o" value="{{ filtros.a√±o or '' }}">
                <input type="hidden" name="mes" value="{{ filtros.mes or '' }}">
                <input type="hidden" name="pagada" value="{{ filtros.pagada or '' }}">
                <input type="hidden" name="sin_comprobante" value="{{ '1' if filtros.sin_comprobante else '' }}">
                <!-- Campos hidden para preservar ordenamiento -->
                <input type="hidden" name="sort_by" value="{{ filtros.sort_by or '' }}">
                <input type="hidden" name="sort_order" value="{{ filtros.sort_order or '' }}">

                <div class="form-group">
                    <label for="comprobante_upload">Seleccionar archivo:</label>
                    <input type="file" name="comprobante" id="comprobante_upload" accept=".png,.jpg,.jpeg,.gif,.pdf" required style="width: 100%; padding: 8px;">
                    <small style="color: #666; display: block; margin-top: 5px;">Formatos permitidos: PNG, JPG, JPEG, GIF, PDF</small>
                </div>

                <div style="margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end;">
                    <button type="button" onclick="cerrarModalComprobante()" class="btn btn-secondary">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Subir Comprobante</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Modal Ver Comprobante -->
<div id="modalVerComprobante" class="modal" style="display: none;">
    <div class="modal-content" style="max-width: 90%; max-height: 90vh;">
        <div class="modal-header">
            <h3>Comprobante de Pago - <span id="modal-ver-comprobante-numero"></span></h3>
            <button onclick="cerrarModalVerComprobante()" class="close-btn">&times;</button>
        </div>
        <div class="modal-body" style="max-height: 80vh; overflow: auto; padding: 10px;">
            <div id="comprobante-container" style="text-align: center;">
                <!-- Aqu√≠ se cargar√° la imagen o PDF -->
            </div>
        </div>
    </div>
</div>

<script>
function abrirModalPago(boletaId, numeroBoleta) {
    // Configurar el formulario con la URL de la boleta
    const form = document.getElementById('formPago');
    form.action = `/boletas/${boletaId}/marcar-pagada`;

    // Mostrar el n√∫mero de boleta
    document.getElementById('modal-numero-boleta').textContent = numeroBoleta;

    // Mostrar el modal
    document.getElementById('modalPago').style.display = 'flex';
}

function cerrarModalPago() {
    document.getElementById('modalPago').style.display = 'none';
    document.getElementById('formPago').reset();
}

// Cerrar modal al hacer clic fuera de √©l
window.onclick = function(event) {
    const modal = document.getElementById('modalPago');
    if (event.target === modal) {
        cerrarModalPago();
    }
}

// Cerrar modal con tecla Escape
document.addEventListener('keydown', function(event) {
    if (event.key === 'Escape') {
        cerrarModalPago();
        cerrarModalDesmarcar();
        cerrarModalComprobante();
        cerrarModalVerComprobante();
    }
});

// Funciones para modal de desmarcar
function abrirModalDesmarcar(boletaId, numeroBoleta) {
    const form = document.getElementById('formDesmarcar');
    form.action = `/boletas/${boletaId}/desmarcar-pagada`;
    document.getElementById('modal-desmarcar-numero').textContent = numeroBoleta;
    document.getElementById('modalDesmarcar').style.display = 'flex';
}

function cerrarModalDesmarcar() {
    document.getElementById('modalDesmarcar').style.display = 'none';
}

// Funciones para modal de subir comprobante
function abrirModalSubirComprobante(boletaId, numeroBoleta) {
    const form = document.getElementById('formComprobante');
    form.action = `/boletas/${boletaId}/subir-comprobante`;
    document.getElementById('modal-comprobante-numero').textContent = numeroBoleta;
    document.getElementById('modalComprobante').style.display = 'flex';
}

function cerrarModalComprobante() {
    document.getElementById('modalComprobante').style.display = 'none';
    document.getElementById('formComprobante').reset();
}

// Funci√≥n para mostrar/ocultar campo de comprobante seg√∫n m√©todo de pago
function toggleComprobante() {
    const metodo = document.getElementById('metodo_pago').value;
    const container = document.getElementById('comprobanteContainer');
    const input = document.getElementById('comprobante');

    if (metodo === 'transferencia') {
        container.style.display = 'block';
        input.required = true;
    } else {
        container.style.display = 'none';
        input.required = false;
        input.value = '';
    }
}

// Funciones para modal de ver comprobante
function abrirModalVerComprobante(comprobantePath, numeroBoleta) {
    document.getElementById('modal-ver-comprobante-numero').textContent = numeroBoleta;

    const container = document.getElementById('comprobante-container');
    const comprobanteUrl = '/' + comprobantePath;

    // Detectar tipo de archivo
    const extension = comprobantePath.split('.').pop().toLowerCase();

    if (extension === 'pdf') {
        // Mostrar PDF en iframe
        container.innerHTML = `
            <iframe src="${comprobanteUrl}"
                    style="width: 100%; height: 70vh; border: none;">
            </iframe>
            <p style="margin-top: 10px;">
                <a href="${comprobanteUrl}" target="_blank" class="btn btn-primary">
                    Abrir PDF en nueva pesta√±a
                </a>
            </p>
        `;
    } else {
        // Mostrar imagen
        container.innerHTML = `
            <img src="${comprobanteUrl}"
                 alt="Comprobante de pago"
                 style="max-width: 100%; max-height: 70vh; object-fit: contain;">
            <p style="margin-top: 10px;">
                <a href="${comprobanteUrl}" target="_blank" class="btn btn-primary">
                    Abrir en nueva pesta√±a
                </a>
            </p>
        `;
    }

    document.getElementById('modalVerComprobante').style.display = 'flex';
}

function cerrarModalVerComprobante() {
    document.getElementById('modalVerComprobante').style.display = 'none';
    document.getElementById('comprobante-container').innerHTML = '';
}

// Funciones para aprobar boletas
function aprobarBoleta(boletaId) {
    if (confirm('¬øEst√° seguro de aprobar esta boleta?')) {
        const form = document.createElement('form');
        form.method = 'POST';
        form.action = `/boletas/${boletaId}/aprobar`;

        // Agregar campos hidden para preservar filtros
        const filtros = {
            'cliente_id': '{{ filtros.cliente_id or "" }}',
            'medidor_id': '{{ filtros.medidor_id or "" }}',
            'a√±o': '{{ filtros.a√±o or "" }}',
            'mes': '{{ filtros.mes or "" }}',
            'pagada': '{{ filtros.pagada if filtros.pagada is not none else "" }}',
            'sin_comprobante': '{{ "1" if filtros.sin_comprobante else "" }}',
            'sort_by': '{{ filtros.sort_by or "" }}',
            'sort_order': '{{ filtros.sort_order or "" }}'
        };

        for (const [key, value] of Object.entries(filtros)) {
            if (value) {
                const input = document.createElement('input');
                input.type = 'hidden';
                input.name = key;
                input.value = value;
                form.appendChild(input);
            }
        }

        document.body.appendChild(form);
        form.submit();
    }
}

// Funciones para rechazar boletas
function rechazarBoleta(boletaId) {
    const motivo = prompt('Ingrese el motivo del rechazo:');
    if (motivo && motivo.trim() !== '') {
        const form = document.createElement('form');
        form.method = 'POST';
        form.action = `/boletas/${boletaId}/rechazar`;

        const inputMotivo = document.createElement('input');
        inputMotivo.type = 'hidden';
        inputMotivo.name = 'motivo';
        inputMotivo.value = motivo.trim();
        form.appendChild(inputMotivo);

        // Agregar campos hidden para preservar filtros
        const filtros = {
            'cliente_id': '{{ filtros.cliente_id or "" }}',
            'medidor_id': '{{ filtros.medidor_id or "" }}',
            'a√±o': '{{ filtros.a√±o or "" }}',
            'mes': '{{ filtros.mes or "" }}',
            'pagada': '{{ filtros.pagada if filtros.pagada is not none else "" }}',
            'sin_comprobante': '{{ "1" if filtros.sin_comprobante else "" }}',
            'sort_by': '{{ filtros.sort_by or "" }}',
            'sort_order': '{{ filtros.sort_order or "" }}'
        };

        for (const [key, value] of Object.entries(filtros)) {
            if (value) {
                const input = document.createElement('input');
                input.type = 'hidden';
                input.name = key;
                input.value = value;
                form.appendChild(input);
            }
        }

        document.body.appendChild(form);
        form.submit();
    } else if (motivo !== null) {
        alert('Debe ingresar un motivo para el rechazo');
    }
}
</script>

<style>
.badge {
    display: inline-block;
    padding: 3px 8px;
    border-radius: 3px;
    font-size: 12px;
    font-weight: bold;
}
.badge-success { background: #28a745; color: white; }
.badge-danger { background: #dc3545; color: white; }
.badge-warning { background: #ffc107; color: black; }
.btn-sm { padding: 3px 8px; font-size: 12px; }
.btn-success { background: #28a745; color: white; }

/* Estilos del modal */
.modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    align-items: center;
    justify-content: center;
}

.modal-content {
    background-color: white;
    border-radius: 8px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    width: 90%;
    max-width: 500px;
    animation: modalFadeIn 0.3s ease;
}

@keyframes modalFadeIn {
    from {
        opacity: 0;
        transform: translateY(-20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px;
    border-bottom: 1px solid #ddd;
}

.modal-header h3 {
    margin: 0;
    font-size: 1.3em;
}

.close-btn {
    background: none;
    border: none;
    font-size: 28px;
    font-weight: bold;
    color: #aaa;
    cursor: pointer;
    padding: 0;
    width: 30px;
    height: 30px;
    line-height: 1;
}

.close-btn:hover {
    color: #000;
}

.modal-body {
    padding: 20px;
}

.modal-body p {
    margin-top: 0;
    font-size: 1.1em;
}

/* Iconos de acciones */
.acciones-icons {
    white-space: nowrap;
}

.action-icon {
    display: inline-block;
    font-size: 18px;
    margin: 0 5px;
    text-decoration: none;
    transition: transform 0.2s;
}

.action-icon:hover {
    transform: scale(1.3);
}

/* Badges clickeables */
.badge-clickable {
    cursor: pointer;
    transition: all 0.2s;
}

.badge-clickable:hover {
    opacity: 0.8;
    transform: translateY(-1px);
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
}

/* √çcono de comprobante */
.comprobante-icon {
    display: inline-block;
    transition: transform 0.2s;
}

.comprobante-icon:hover {
    transform: scale(1.3);
}
</style>
{% endblock %}
